#pragma once

#include <memory>
#include <nlohmann/json.hpp>
#include <string>

#include "../Messages/Response/ResponseMessage.h"
#include "Ls6502Facade.h"

namespace justanlsp
{

//////////////////////////////////////////////////////////////
///
/// @class Ls6502Server
///
/// @brief Ls6502 entry class, responsible for starting the server
///
//////////////////////////////////////////////////////////////
class Ls6502Server
{
  public:
    //////////////////////////////////////////////////////////////
    ///
    /// @brief Constructs (creates instance) of the Ls6502Server
    ///
    //////////////////////////////////////////////////////////////
    Ls6502Server() = default;

    //////////////////////////////////////////////////////////////
    ///
    /// @brief Tilda Swilton (destructs Ls6502 server)
    ///
    //////////////////////////////////////////////////////////////
    ~Ls6502Server() = default;

    //////////////////////////////////////////////////////////////
    ///
    /// @brief Starts the Ls6502 server
    ///
    //////////////////////////////////////////////////////////////
    void run();

    //////////////////////////////////////////////////////////////
    ///
    /// @brief Initializes the Ls6502 server
    ///
    //////////////////////////////////////////////////////////////
    void init();

    //////////////////////////////////////////////////////////////
    ///
    /// @brief Shutdown of the Ls6502 server
    ///
    //////////////////////////////////////////////////////////////
    void shutdown();

  private:
    //////////////////////////////////////////////////////////////
    ///
    /// @brief Distributes requests to Ls6502 facade
    ///
    //////////////////////////////////////////////////////////////
    void handleRequest(const std::string &request);

  private:
    //////////////////////////////////////////////////////////////
    ///
    /// @brief Single simplified interface for handling JustAnLspLSP
    ///        request messages
    ///
    //////////////////////////////////////////////////////////////
    std::shared_ptr<Ls6502Facade> m_justAnLspFacade = std::make_shared<Ls6502Facade>();
};

} // namespace justanlsp
